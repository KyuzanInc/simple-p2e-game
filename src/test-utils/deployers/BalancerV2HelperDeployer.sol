// SPDX-License-Identifier: MIT
pragma solidity >=0.7.0;

contract BalancerV2HelperDeployer {
    address public immutable helper;

    constructor(bytes32 salt, address vault, address poolFactory) {
        bytes memory helperCode =
            hex"6101006040526706f05b59d3b2000060c081815260e0919091526200002990600090600262000079565b503480156200003757600080fd5b506040516200184c3803806200184c8339810160408190526200005a91620000eb565b6001600160601b0319606092831b8116608052911b1660a05262000142565b828054828255906000526020600020908101928215620000c2579160200282015b82811115620000c257825182906001600160401b03169055916020019190600101906200009a565b50620000d0929150620000d4565b5090565b5b80821115620000d05760008155600101620000d5565b60008060408385031215620000fe578182fd5b82516200010b8162000129565b60208401519092506200011e8162000129565b809150509250929050565b6001600160a01b03811681146200013f57600080fd5b50565b60805160601c60a05160601c6116bd6200018f6000398061031852806103f6525080610492528061054b528061071d52806107ca52806108835280610af45280610b7f52506116bd6000f3fe6080604052600436106100555760003560e01c80631a6e5f771461005a5780634219dc40146100905780638da4e9c0146100a5578063d9134b3e146100c5578063fbfa77cf146100da578063fc8b02c5146100ef575b600080fd5b34801561006657600080fd5b5061007a610075366004611026565b610102565b6040516100879190611305565b60405180910390f35b34801561009c57600080fd5b5061007a6103f4565b6100b86100b3366004610f3b565b610418565b604051610087919061122b565b6100d86100d3366004610f9e565b61086b565b005b3480156100e657600080fd5b5061007a610881565b6100d86100fd366004610f9e565b6108a5565b600064e8d4a51000826060015110156101215764e8d4a5100060608301525b60408051600280825260608083018452926020830190803683370190505090508260a001516001600160a01b031683608001516001600160a01b031610156101cc5782608001518160008151811061017557fe5b60200260200101906001600160a01b031690816001600160a01b0316815250508260a00151816001815181106101a757fe5b60200260200101906001600160a01b031690816001600160a01b031681525050610231565b8260a00151816000815181106101de57fe5b60200260200101906001600160a01b031690816001600160a01b03168152505082608001518160018151811061021057fe5b60200260200101906001600160a01b031690816001600160a01b0316815250505b604080516002808252606080830184529260208301908036833701905050905060405161025d90610c95565b604051809103906000f080158015610279573d6000803e3d6000fd5b508160008151811061028757fe5b60200260200101906001600160a01b031690816001600160a01b0316815250506040516102b390610c95565b604051809103906000f0801580156102cf573d6000803e3d6000fd5b50816001815181106102dd57fe5b6001600160a01b039283166020918202929092018101919091528501516040808701516060880151885192516380773a9360e01b81526000957f000000000000000000000000000000000000000000000000000000000000000016946380773a939461035594919391928a9289928b926004016113b3565b602060405180830381600087803b15801561036f57600080fd5b505af1158015610383573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906103a79190610e34565b90507fd2b6214e0dfc2bc5cb2e4eb6bf3b3b4ab7b71f56bf550c1953d1d47c7647c83285602001518660400151836040516103e493929190611375565b60405180910390a1949350505050565b7f000000000000000000000000000000000000000000000000000000000000000081565b600080866001600160a01b03166338fff2d06040518163ffffffff1660e01b815260040160206040518083038186803b15801561045457600080fd5b505afa158015610468573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061048c9190610f23565b905060607f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031663f94d4668836040518263ffffffff1660e01b81526004016104dc919061122b565b60006040518083038186803b1580156104f457600080fd5b505afa158015610508573d6000803e3d6000fd5b505050506040513d6000823e601f3d908101601f191682016040526105309190810190610e57565b50909150600090506001600160a01b038616158015610617577f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031663ad5c46486040518163ffffffff1660e01b815260040160206040518083038186803b1580156105a257600080fd5b505afa1580156105b6573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906105da9190610e34565b6001600160a01b0316836000815181106105f057fe5b60200260200101516001600160a01b03161461060d576000610610565b60015b9150610651565b8260008151811061062457fe5b60200260200101516001600160a01b0316876001600160a01b03161461064b57600061064e565b60015b91505b610659610ca1565b6040805160c081019091528581526020810160008152602001896001600160a01b03168152602001858560ff168151811061069057fe5b60200260200101516001600160a01b031681526020018881526020016040518060200160405280600081525081525090506106c9610cea565b50604080516080810182526001600160a01b03808d168252600060208301819052908c16928201929092526060810182905290603c420184156107b3576040516352bbbe2960e01b81526001600160a01b037f000000000000000000000000000000000000000000000000000000000000000016906352bbbe2990349061075a9088908890889088906004016114a6565b6020604051808303818588803b15801561077357600080fd5b505af1158015610787573d6000803e3d6000fd5b50505050506040513d601f19601f820116820180604052508101906107ac9190610f23565b985061085a565b6040516352bbbe2960e01b81526001600160a01b037f000000000000000000000000000000000000000000000000000000000000000016906352bbbe29906108059087908790879087906004016114a6565b602060405180830381600087803b15801561081f57600080fd5b505af1158015610833573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906108579190610f23565b98505b505050505050505095945050505050565b61087a858585858560006108b0565b5050505050565b7f000000000000000000000000000000000000000000000000000000000000000081565b61087a858585858560015b6040805160028082526060808301845292602083019080368337505060408051600280825260608083018452949550909250906020830190803683370190505090506108ff602086018661100a565b61090f604087016020880161100a565b8360008151811061091c57fe5b602002602001018460018151811061093057fe5b6001600160a01b03938416602091820292909201015291169052836000602002013584600160200201358260008151811061096757fe5b602002602001018360018151811061097b57fe5b6020908102919091010191909152526060600084600381111561099a57fe5b14156109c95783826040516020016109b3929190611319565b6040516020818303038152906040529050610a2c565b60018460038111156109d757fe5b1415610a0b5760008483826040516020016109f493929190611343565b604051602081830303815290604052915050610a2c565b60405162461bcd60e51b8152600401610a2390611461565b60405180910390fd5b610a34610d11565b6040518060800160405280610a4886610bfa565b815260200184815260200183815260200160001515815250905060008a6001600160a01b03166338fff2d06040518163ffffffff1660e01b815260040160206040518083038186803b158015610a9d57600080fd5b505afa158015610ab1573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610ad59190610f23565b90503415610b685760405163172b958560e31b81526001600160a01b037f0000000000000000000000000000000000000000000000000000000000000000169063b95cac28903490610b319085908f908f908990600401611234565b6000604051808303818588803b158015610b4a57600080fd5b505af1158015610b5e573d6000803e3d6000fd5b5050505050610bed565b60405163172b958560e31b81526001600160a01b037f0000000000000000000000000000000000000000000000000000000000000000169063b95cac2890610bba9084908e908e908890600401611234565b600060405180830381600087803b158015610bd457600080fd5b505af1158015610be8573d6000803e3d6000fd5b505050505b5050505050505050505050565b606080825167ffffffffffffffff81118015610c1557600080fd5b50604051908082528060200260200182016040528015610c3f578160200160208202803683370190505b50905060005b8351811015610c8e57838181518110610c5a57fe5b6020026020010151828281518110610c6e57fe5b6001600160a01b0390921660209283029190910190910152600101610c45565b5092915050565b60d7806115b183390190565b6040805160c0810190915260008082526020820190815260200160006001600160a01b0316815260200160006001600160a01b0316815260200160008152602001606081525090565b60408051608081018252600080825260208201819052918101829052606081019190915290565b60405180608001604052806060815260200160608152602001606081526020016000151581525090565b8035610d468161159b565b92915050565b8060408101831015610d4657600080fd5b600082601f830112610d6d578081fd5b8151610d80610d7b82611558565b611531565b818152915060208083019084810181840286018201871015610da157600080fd5b60005b84811015610dc057815184529282019290820190600101610da4565b505050505092915050565b600082601f830112610ddb578081fd5b813567ffffffffffffffff811115610df1578182fd5b610e04601f8201601f1916602001611531565b9150808252836020828501011115610e1b57600080fd5b8060208401602084013760009082016020015292915050565b600060208284031215610e45578081fd5b8151610e508161159b565b9392505050565b600080600060608486031215610e6b578182fd5b835167ffffffffffffffff80821115610e82578384fd5b818601915086601f830112610e95578384fd5b8151610ea3610d7b82611558565b80828252602080830192508086018b828387028901011115610ec3578889fd5b8896505b84871015610eee578051610eda8161159b565b845260019690960195928101928101610ec7565b508901519097509350505080821115610f05578384fd5b50610f1286828701610d5d565b925050604084015190509250925092565b600060208284031215610f34578081fd5b5051919050565b600080600080600060a08688031215610f52578081fd5b8535610f5d8161159b565b94506020860135610f6d8161159b565b93506040860135610f7d8161159b565b92506060860135610f8d8161159b565b949793965091946080013592915050565b600080600080600060e08688031215610fb5578081fd5b8535610fc08161159b565b94506020860135610fd08161159b565b93506040860135610fe08161159b565b9250610fef8760608801610d4c565b9150610ffe8760a08801610d4c565b90509295509295909350565b60006020828403121561101b578081fd5b8135610e508161159b565b600060208284031215611037578081fd5b813567ffffffffffffffff8082111561104e578283fd5b9083019060c08286031215611061578283fd5b61106b60c0611531565b6110758684610d3b565b8152602083013582811115611088578485fd5b61109487828601610dcb565b6020830152506040830135828111156110ab578485fd5b6110b787828601610dcb565b604083015250606083013560608201526110d48660808501610d3b565b60808201526110e68660a08501610d3b565b60a082015295945050505050565b6001600160a01b03169052565b6000815180845260208085019450808401835b838110156111395781516001600160a01b031687529582019590820190600101611114565b509495945050505050565b6000815180845260208085019450808401835b8381101561113957815187529582019590820190600101611157565b6000815480845260208085019450838352808320835b8381101561113957815487529582019560019182019101611189565b15159052565b60008151808452815b818110156111d0576020818501810151868301820152016111b4565b818111156111e15782602083870101525b50601f01601f19169290920160200192915050565b80516001600160a01b039081168352602080830151151590840152604080830151909116908301526060908101511515910152565b90815260200190565b8481526001600160a01b038481166020808401919091529084166040830152608060608301819052835181840191909152805161010084018190526000929182019083906101208601905b808310156112a7576112918451611578565b825292840192600192909201919084019061127f565b50838701519350607f199250828682030160a08701526112c78185611144565b935050506040850151818584030160c08601526112e483826111ab565b9250505060608401516112fa60e08501826111a5565b509695505050505050565b6001600160a01b0391909116815260200190565b600061132484611584565b8382526040602083015261133b6040830184611144565b949350505050565b600061134e85611584565b848252606060208301526113656060830185611144565b9050826040830152949350505050565b60006060825261138860608301866111ab565b828103602084015261139a81866111ab565b91505060018060a01b0383166040830152949350505050565b600060e082526113c660e083018a6111ab565b6020838203818501526113d9828b6111ab565b84810360408601528951808252828b01935090820190845b81811015611415576114038551611578565b835293830193918301916001016113f1565b50508481036060860152611429818a611173565b92505050828103608084015261143f8187611101565b9150508360a083015261145560c08301846110f4565b98975050505050505050565b60208082526025908201527f496e76616c6964205765696768746564506f6f6c55736572446174612e4a6f696040820152641b92da5b9960da1b606082015260800190565b600060e08252855160e083015260208601516114c181611591565b61010083015260408601516001600160a01b03908116610120840152606087015116610140830152608086015161016083015260a086015160c061018084015261150f6101a08401826111ab565b91505061151f60208301866111f6565b60a082019390935260c0015292915050565b60405181810167ffffffffffffffff8111828210171561155057600080fd5b604052919050565b600067ffffffffffffffff82111561156e578081fd5b5060209081020190565b6001600160a01b031690565b6004811061158e57fe5b50565b6002811061158e57fe5b6001600160a01b038116811461158e57600080fdfe608060405234801561001057600080fd5b50670de0b6b3a764000060005560ac8061002b6000396000f3fe6080604052348015600f57600080fd5b506004361060325760003560e01c8063679aefce146037578063a1cfa04114604f575b600080fd5b603d606b565b60408051918252519081900360200190f35b606960048036036020811015606357600080fd5b50356071565b005b60005490565b60005556fea2646970667358221220bc5f0ccb8dff3a4b378453120a6994c4be4879dd975701290bf22982fd32fe9964736f6c63430007010033a2646970667358221220e7c73ac31bbc7b63c080ca1adaba42273d84f96278a8aa31281df7b8c7a767a964736f6c63430007010033";
        bytes memory helperConstructorArgs = abi.encode(vault, poolFactory);
        bytes memory helperDeployCode = abi.encodePacked(helperCode, helperConstructorArgs);

        address _helper;
        assembly {
            _helper := create2(0, add(helperDeployCode, 0x20), mload(helperDeployCode), salt)
        }
        require(_helper != address(0), "Failed to deploy BalancerV2Helper");

        helper = _helper;
    }
}
