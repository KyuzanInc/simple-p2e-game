// SPDX-License-Identifier: MIT
pragma solidity >=0.7.0;

contract BalancerV2HelperDeployer {
    address public immutable helper;

    constructor(bytes32 salt, address vault, address poolFactory) {
        bytes memory helperCode =
            hex"6101006040526706f05b59d3b2000060c081815260e0919091526200002990600090600262000079565b503480156200003757600080fd5b5060405162001523380380620015238339810160408190526200005a91620000eb565b6001600160601b0319606092831b8116608052911b1660a05262000142565b828054828255906000526020600020908101928215620000c2579160200282015b82811115620000c257825182906001600160401b03169055916020019190600101906200009a565b50620000d0929150620000d4565b5090565b5b80821115620000d05760008155600101620000d5565b60008060408385031215620000fe578182fd5b82516200010b8162000129565b60208401519092506200011e8162000129565b809150509250929050565b6001600160a01b03811681146200013f57600080fd5b50565b60805160601c60a05160601c61139e620001856000398061031852806103f652508061054552806105f252806106a9528061091a52806109a5525061139e6000f3fe6080604052600436106100555760003560e01c80631a6e5f771461005a5780634219dc4014610090578063a01f83ae146100a5578063d9134b3e146100c5578063fbfa77cf146100da578063fc8b02c5146100ef575b600080fd5b34801561006657600080fd5b5061007a610075366004610d27565b610102565b6040516100879190610ffd565b60405180910390f35b34801561009c57600080fd5b5061007a6103f4565b6100b86100b3366004610c43565b610418565b6040516100879190611229565b6100d86100d3366004610cbb565b610691565b005b3480156100e657600080fd5b5061007a6106a7565b6100d86100fd366004610cbb565b6106cb565b600064e8d4a51000826060015110156101215764e8d4a5100060608301525b60408051600280825260608083018452926020830190803683370190505090508260a001516001600160a01b031683608001516001600160a01b031610156101cc5782608001518160008151811061017557fe5b60200260200101906001600160a01b031690816001600160a01b0316815250508260a00151816001815181106101a757fe5b60200260200101906001600160a01b031690816001600160a01b031681525050610231565b8260a00151816000815181106101de57fe5b60200260200101906001600160a01b031690816001600160a01b03168152505082608001518160018151811061021057fe5b60200260200101906001600160a01b031690816001600160a01b0316815250505b604080516002808252606080830184529260208301908036833701905050905060405161025d90610abb565b604051809103906000f080158015610279573d6000803e3d6000fd5b508160008151811061028757fe5b60200260200101906001600160a01b031690816001600160a01b0316815250506040516102b390610abb565b604051809103906000f0801580156102cf573d6000803e3d6000fd5b50816001815181106102dd57fe5b6001600160a01b039283166020918202929092018101919091528501516040808701516060880151885192516380773a9360e01b81526000957f000000000000000000000000000000000000000000000000000000000000000016946380773a939461035594919391928a9289928b926004016110ab565b602060405180830381600087803b15801561036f57600080fd5b505af1158015610383573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906103a79190610bec565b90507fd2b6214e0dfc2bc5cb2e4eb6bf3b3b4ab7b71f56bf550c1953d1d47c7647c83285602001518660400151836040516103e49392919061106d565b60405180910390a1949350505050565b7f000000000000000000000000000000000000000000000000000000000000000081565b6000610422610ac7565b6040518060c00160405280896001600160a01b03166338fff2d06040518163ffffffff1660e01b815260040160206040518083038186803b15801561046657600080fd5b505afa15801561047a573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061049e9190610c0f565b815260200160008152602001866001600160a01b03168152602001856001600160a01b031681526020018481526020016040518060200160405280600081525081525090506104eb610b10565b50604080516080810182526001600160a01b03808a1682526000602083018190528982169383019390935260608201839052909190603c42019088161580156105db576040516352bbbe2960e01b81526001600160a01b037f000000000000000000000000000000000000000000000000000000000000000016906352bbbe2990349061058290899089908990899060040161119e565b6020604051808303818588803b15801561059b57600080fd5b505af11580156105af573d6000803e3d6000fd5b50505050506040513d601f19601f820116820180604052508101906105d49190610c0f565b9550610682565b6040516352bbbe2960e01b81526001600160a01b037f000000000000000000000000000000000000000000000000000000000000000016906352bbbe299061062d90889088908890889060040161119e565b602060405180830381600087803b15801561064757600080fd5b505af115801561065b573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061067f9190610c0f565b95505b50505050509695505050505050565b6106a0858585858560006106d6565b5050505050565b7f000000000000000000000000000000000000000000000000000000000000000081565b6106a0858585858560015b6040805160028082526060808301845292602083019080368337505060408051600280825260608083018452949550909250906020830190803683370190505090506107256020860186610c27565b6107356040870160208801610c27565b8360008151811061074257fe5b602002602001018460018151811061075657fe5b6001600160a01b03938416602091820292909201015291169052836000602002013584600160200201358260008151811061078d57fe5b60200260200101836001815181106107a157fe5b602090810291909101019190915252606060008460038111156107c057fe5b14156107ef5783826040516020016107d9929190611011565b6040516020818303038152906040529050610852565b60018460038111156107fd57fe5b141561083157600084838260405160200161081a9392919061103b565b604051602081830303815290604052915050610852565b60405162461bcd60e51b815260040161084990611159565b60405180910390fd5b61085a610b37565b604051806080016040528061086e86610a20565b815260200184815260200183815260200160001515815250905060008a6001600160a01b03166338fff2d06040518163ffffffff1660e01b815260040160206040518083038186803b1580156108c357600080fd5b505afa1580156108d7573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906108fb9190610c0f565b9050341561098e5760405163172b958560e31b81526001600160a01b037f0000000000000000000000000000000000000000000000000000000000000000169063b95cac289034906109579085908f908f908990600401610f2c565b6000604051808303818588803b15801561097057600080fd5b505af1158015610984573d6000803e3d6000fd5b5050505050610a13565b60405163172b958560e31b81526001600160a01b037f0000000000000000000000000000000000000000000000000000000000000000169063b95cac28906109e09084908e908e908890600401610f2c565b600060405180830381600087803b1580156109fa57600080fd5b505af1158015610a0e573d6000803e3d6000fd5b505050505b5050505050505050505050565b606080825167ffffffffffffffff81118015610a3b57600080fd5b50604051908082528060200260200182016040528015610a65578160200160208202803683370190505b50905060005b8351811015610ab457838181518110610a8057fe5b6020026020010151828281518110610a9457fe5b6001600160a01b0390921660209283029190910190910152600101610a6b565b5092915050565b60d78061129283390190565b6040805160c0810190915260008082526020820190815260200160006001600160a01b0316815260200160006001600160a01b0316815260200160008152602001606081525090565b60408051608081018252600080825260208201819052918101829052606081019190915290565b60405180608001604052806060815260200160608152602001606081526020016000151581525090565b8035610b6c8161127c565b92915050565b8060408101831015610b6c57600080fd5b600082601f830112610b93578081fd5b813567ffffffffffffffff811115610ba9578182fd5b610bbc601f8201601f1916602001611232565b9150808252836020828501011115610bd357600080fd5b8060208401602084013760009082016020015292915050565b600060208284031215610bfd578081fd5b8151610c088161127c565b9392505050565b600060208284031215610c20578081fd5b5051919050565b600060208284031215610c38578081fd5b8135610c088161127c565b60008060008060008060c08789031215610c5b578182fd5b8635610c668161127c565b95506020870135610c768161127c565b94506040870135610c868161127c565b93506060870135610c968161127c565b92506080870135610ca68161127c565b8092505060a087013590509295509295509295565b600080600080600060e08688031215610cd2578081fd5b8535610cdd8161127c565b94506020860135610ced8161127c565b93506040860135610cfd8161127c565b9250610d0c8760608801610b72565b9150610d1b8760a08801610b72565b90509295509295909350565b600060208284031215610d38578081fd5b813567ffffffffffffffff80821115610d4f578283fd5b9083019060c08286031215610d62578283fd5b610d6c60c0611232565b610d768684610b61565b8152602083013582811115610d89578485fd5b610d9587828601610b83565b602083015250604083013582811115610dac578485fd5b610db887828601610b83565b60408301525060608301356060820152610dd58660808501610b61565b6080820152610de78660a08501610b61565b60a082015295945050505050565b6001600160a01b03169052565b6000815180845260208085019450808401835b83811015610e3a5781516001600160a01b031687529582019590820190600101610e15565b509495945050505050565b6000815180845260208085019450808401835b83811015610e3a57815187529582019590820190600101610e58565b6000815480845260208085019450838352808320835b83811015610e3a57815487529582019560019182019101610e8a565b15159052565b60008151808452815b81811015610ed157602081850181015186830182015201610eb5565b81811115610ee25782602083870101525b50601f01601f19169290920160200192915050565b80516001600160a01b039081168352602080830151151590840152604080830151909116908301526060908101511515910152565b8481526001600160a01b038481166020808401919091529084166040830152608060608301819052835181840191909152805161010084018190526000929182019083906101208601905b80831015610f9f57610f898451611259565b8252928401926001929092019190840190610f77565b50838701519350607f199250828682030160a0870152610fbf8185610e45565b935050506040850151818584030160c0860152610fdc8382610eac565b925050506060840151610ff260e0850182610ea6565b509695505050505050565b6001600160a01b0391909116815260200190565b600061101c84611265565b838252604060208301526110336040830184610e45565b949350505050565b600061104685611265565b8482526060602083015261105d6060830185610e45565b9050826040830152949350505050565b6000606082526110806060830186610eac565b82810360208401526110928186610eac565b91505060018060a01b0383166040830152949350505050565b600060e082526110be60e083018a610eac565b6020838203818501526110d1828b610eac565b84810360408601528951808252828b01935090820190845b8181101561110d576110fb8551611259565b835293830193918301916001016110e9565b50508481036060860152611121818a610e74565b9250505082810360808401526111378187610e02565b9150508360a083015261114d60c0830184610df5565b98975050505050505050565b60208082526025908201527f496e76616c6964205765696768746564506f6f6c55736572446174612e4a6f696040820152641b92da5b9960da1b606082015260800190565b600060e08252855160e083015260208601516111b981611272565b61010083015260408601516001600160a01b03908116610120840152606087015116610140830152608086015161016083015260a086015160c06101808401526112076101a0840182610eac565b9150506112176020830186610ef7565b60a082019390935260c0015292915050565b90815260200190565b60405181810167ffffffffffffffff8111828210171561125157600080fd5b604052919050565b6001600160a01b031690565b6004811061126f57fe5b50565b6002811061126f57fe5b6001600160a01b038116811461126f57600080fdfe608060405234801561001057600080fd5b50670de0b6b3a764000060005560ac8061002b6000396000f3fe6080604052348015600f57600080fd5b506004361060325760003560e01c8063679aefce146037578063a1cfa04114604f575b600080fd5b603d606b565b60408051918252519081900360200190f35b606960048036036020811015606357600080fd5b50356071565b005b60005490565b60005556fea2646970667358221220a3dd09add1b304b0e7010a6cb357258cadd86a472131cdbf50d108e4bb9041c564736f6c63430007010033a2646970667358221220ef5f8c28b49d1bcfd2153d43609a11ea3fd9ee01c3b5c44e43b6d91c49c5f12e64736f6c63430007010033";
        bytes memory helperConstructorArgs = abi.encode(vault, poolFactory);
        bytes memory helperDeployCode = abi.encodePacked(helperCode, helperConstructorArgs);

        address _helper;
        assembly {
            _helper := create2(0, add(helperDeployCode, 0x20), mload(helperDeployCode), salt)
        }
        require(_helper != address(0), "Failed to deploy BalancerV2Helper");

        helper = _helper;
    }
}
